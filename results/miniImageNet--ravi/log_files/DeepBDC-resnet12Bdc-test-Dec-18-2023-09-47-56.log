2023-12-18 09:47:56,379 [INFO] core.test: {'data_root': '/root/autodl-tmp/data/miniImageNet--ravi', 'image_size': 84, 'use_memory': False, 'augment': True, 'augment_times': 1, 'augment_times_query': 1, 'workers': 8, 'dataloader_num': 1, 'device_ids': '0', 'n_gpu': 1, 'seed': 2147483647, 'deterministic': True, 'port': 26687, 'log_name': None, 'log_level': 'info', 'log_interval': 100, 'log_paramerter': False, 'result_root': './results', 'save_interval': 10, 'save_part': ['emb_func', 'cls_classifier'], 'tag': None, 'epoch': 200, 'test_epoch': 5, 'parallel_part': ['emb_func'], 'pretrain_path': './results/DeepBDC/DeepBDC-meta-miniImageNet-5-1/checkpoints/emb_func_best.pth', 'resume': False, 'way_num': 5, 'shot_num': 1, 'query_num': 15, 'test_way': 5, 'test_shot': 1, 'test_query': 15, 'episode_size': 2, 'train_episode': 600, 'test_episode': 600, 'batch_size': 64, 'val_per_epoch': 1, 'optimizer': {'kwargs': {'lr': 0.0001, 'momentum': 0.9, 'nesterov': True, 'weight_decay': 0.0005}, 'name': 'SGD', 'other': None}, 'lr_scheduler': {'kwargs': {'gamma': 0.1, 'milestones': [40, 80]}, 'name': 'MultiStepLR'}, 'warmup': 0, 'includes': ['headers/data.yaml', 'headers/device.yaml', 'headers/misc.yaml', 'headers/model.yaml', 'headers/optimizer.yaml'], 'augment_method': 'DeepBdcAugment', 'backbone': {'kwargs': {'reduce_dim': 640}, 'name': 'resnet12Bdc'}, 'classifier': {'kwargs': None, 'name': 'DeepBDC'}, 'rank': 0, 'tb_scale': 1.0}
2023-12-18 09:47:56,664 [INFO] core.test: DeepBDC(
  (emb_func): resnet(
    (layer1): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer2): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(64, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(64, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer3): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(160, 320, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer4): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=1, stride=1, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(320, 640, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (dropout): Dropout(p=0.0, inplace=False)
    (bdc_pool): BdcPool()
  )
  (proto_layer): ProtoLayer()
  (loss_func): CrossEntropyLoss()
)
2023-12-18 09:47:56,720 [INFO] core.test: Trainable params in the model: 12424321.
2023-12-18 09:47:56,722 [INFO] core.test: Loading the state dict from ./results/DeepBDC-miniImageNet--ravi-resnet12Bdc-5-1-Dec-15-2023-20-49-12/checkpoints/model_best.pth.
2023-12-18 09:48:02,570 [INFO] core.test: load 12000 test image with 20 label.
2023-12-18 09:48:04,669 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:48:13,140 [INFO] core.test: Epoch-(0): [100/600]	Time 0.202 (0.169)	Calc 0.095 (0.097)	Data 0.103 (0.069)	Acc@1 69.333 (68.080)
2023-12-18 09:48:20,363 [INFO] core.test: Epoch-(0): [200/600]	Time 0.116 (0.156)	Calc 0.095 (0.096)	Data 0.018 (0.057)	Acc@1 59.333 (65.687)
2023-12-18 09:48:27,988 [INFO] core.test: Epoch-(0): [300/600]	Time 0.098 (0.155)	Calc 0.095 (0.095)	Data 0.001 (0.056)	Acc@1 82.000 (66.236)
2023-12-18 09:48:34,728 [INFO] core.test: Epoch-(0): [400/600]	Time 0.174 (0.150)	Calc 0.094 (0.095)	Data 0.076 (0.051)	Acc@1 68.667 (66.193)
2023-12-18 09:48:41,204 [INFO] core.test: Epoch-(0): [500/600]	Time 0.098 (0.145)	Calc 0.095 (0.095)	Data 0.001 (0.047)	Acc@1 67.333 (66.133)
2023-12-18 09:48:48,292 [INFO] core.test: Epoch-(0): [600/600]	Time 0.413 (0.145)	Calc 0.095 (0.095)	Data 0.314 (0.047)	Acc@1 76.000 (66.344)
2023-12-18 09:48:48,297 [INFO] core.test: Test Accuracy: 66.344	 h: 0.856
2023-12-18 09:48:48,299 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:48:54,574 [INFO] core.test: Epoch-(1): [100/600]	Time 0.100 (0.125)	Calc 0.097 (0.096)	Data 0.001 (0.026)	Acc@1 60.667 (64.187)
2023-12-18 09:49:00,833 [INFO] core.test: Epoch-(1): [200/600]	Time 0.098 (0.125)	Calc 0.095 (0.095)	Data 0.001 (0.026)	Acc@1 62.667 (64.053)
2023-12-18 09:49:08,691 [INFO] core.test: Epoch-(1): [300/600]	Time 0.098 (0.135)	Calc 0.095 (0.095)	Data 0.001 (0.037)	Acc@1 66.000 (64.511)
2023-12-18 09:49:15,184 [INFO] core.test: Epoch-(1): [400/600]	Time 0.099 (0.134)	Calc 0.095 (0.095)	Data 0.001 (0.036)	Acc@1 67.333 (64.907)
2023-12-18 09:49:21,912 [INFO] core.test: Epoch-(1): [500/600]	Time 0.104 (0.134)	Calc 0.100 (0.095)	Data 0.001 (0.036)	Acc@1 52.667 (65.163)
2023-12-18 09:49:29,716 [INFO] core.test: Epoch-(1): [600/600]	Time 0.103 (0.137)	Calc 0.095 (0.095)	Data 0.006 (0.039)	Acc@1 65.333 (64.980)
2023-12-18 09:49:29,722 [INFO] core.test: Test Accuracy: 64.980	 h: 0.841
2023-12-18 09:49:29,727 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:49:36,950 [INFO] core.test: Epoch-(2): [100/600]	Time 0.347 (0.144)	Calc 0.096 (0.096)	Data 0.247 (0.046)	Acc@1 67.333 (64.587)
2023-12-18 09:49:43,922 [INFO] core.test: Epoch-(2): [200/600]	Time 0.104 (0.141)	Calc 0.100 (0.096)	Data 0.001 (0.043)	Acc@1 61.333 (65.467)
2023-12-18 09:49:50,395 [INFO] core.test: Epoch-(2): [300/600]	Time 0.100 (0.137)	Calc 0.096 (0.096)	Data 0.001 (0.039)	Acc@1 55.333 (65.822)
2023-12-18 09:49:57,141 [INFO] core.test: Epoch-(2): [400/600]	Time 0.099 (0.136)	Calc 0.095 (0.096)	Data 0.001 (0.038)	Acc@1 83.333 (65.950)
2023-12-18 09:50:04,521 [INFO] core.test: Epoch-(2): [500/600]	Time 0.100 (0.139)	Calc 0.096 (0.096)	Data 0.001 (0.040)	Acc@1 66.667 (66.259)
2023-12-18 09:50:11,602 [INFO] core.test: Epoch-(2): [600/600]	Time 0.126 (0.139)	Calc 0.096 (0.096)	Data 0.027 (0.040)	Acc@1 48.000 (66.122)
2023-12-18 09:50:11,607 [INFO] core.test: Test Accuracy: 66.122	 h: 0.839
2023-12-18 09:50:11,609 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:50:17,989 [INFO] core.test: Epoch-(3): [100/600]	Time 0.099 (0.127)	Calc 0.095 (0.096)	Data 0.001 (0.028)	Acc@1 76.667 (64.787)
2023-12-18 09:50:24,634 [INFO] core.test: Epoch-(3): [200/600]	Time 0.220 (0.130)	Calc 0.095 (0.096)	Data 0.121 (0.031)	Acc@1 72.667 (64.940)
2023-12-18 09:50:31,185 [INFO] core.test: Epoch-(3): [300/600]	Time 0.104 (0.130)	Calc 0.095 (0.096)	Data 0.005 (0.031)	Acc@1 72.667 (64.911)
2023-12-18 09:50:38,437 [INFO] core.test: Epoch-(3): [400/600]	Time 0.098 (0.133)	Calc 0.095 (0.096)	Data 0.001 (0.035)	Acc@1 60.667 (64.937)
2023-12-18 09:50:44,602 [INFO] core.test: Epoch-(3): [500/600]	Time 0.100 (0.131)	Calc 0.095 (0.096)	Data 0.001 (0.033)	Acc@1 64.000 (65.045)
2023-12-18 09:50:53,158 [INFO] core.test: Epoch-(3): [600/600]	Time 0.101 (0.138)	Calc 0.096 (0.096)	Data 0.001 (0.039)	Acc@1 71.333 (65.373)
2023-12-18 09:50:53,164 [INFO] core.test: Test Accuracy: 65.373	 h: 0.790
2023-12-18 09:50:53,166 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:51:00,290 [INFO] core.test: Epoch-(4): [100/600]	Time 0.099 (0.142)	Calc 0.096 (0.096)	Data 0.001 (0.043)	Acc@1 62.000 (66.987)
2023-12-18 09:51:06,692 [INFO] core.test: Epoch-(4): [200/600]	Time 0.098 (0.135)	Calc 0.095 (0.096)	Data 0.001 (0.036)	Acc@1 74.000 (66.413)
2023-12-18 09:51:13,514 [INFO] core.test: Epoch-(4): [300/600]	Time 0.098 (0.135)	Calc 0.095 (0.096)	Data 0.001 (0.037)	Acc@1 59.333 (65.471)
2023-12-18 09:51:20,596 [INFO] core.test: Epoch-(4): [400/600]	Time 0.514 (0.137)	Calc 0.095 (0.096)	Data 0.416 (0.038)	Acc@1 58.667 (65.307)
2023-12-18 09:51:26,658 [INFO] core.test: Epoch-(4): [500/600]	Time 0.101 (0.133)	Calc 0.097 (0.096)	Data 0.001 (0.035)	Acc@1 62.000 (65.168)
2023-12-18 09:51:33,468 [INFO] core.test: Epoch-(4): [600/600]	Time 0.099 (0.134)	Calc 0.096 (0.096)	Data 0.001 (0.036)	Acc@1 56.667 (65.409)
2023-12-18 09:51:33,472 [INFO] core.test: Test Accuracy: 65.409	 h: 0.821
2023-12-18 09:51:33,476 [INFO] core.test: Aver Accuracy: 65.646	 Aver h: 0.370
2023-12-18 09:51:33,477 [INFO] core.test: ............Testing is end............
