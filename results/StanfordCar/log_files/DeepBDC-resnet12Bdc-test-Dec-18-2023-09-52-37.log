2023-12-18 09:52:37,830 [INFO] core.test: {'data_root': '/root/autodl-tmp/data/StanfordCar', 'image_size': 84, 'use_memory': False, 'augment': True, 'augment_times': 1, 'augment_times_query': 1, 'workers': 8, 'dataloader_num': 1, 'device_ids': '0', 'n_gpu': 1, 'seed': 2147483647, 'deterministic': True, 'port': 27041, 'log_name': None, 'log_level': 'info', 'log_interval': 100, 'log_paramerter': False, 'result_root': './results', 'save_interval': 10, 'save_part': ['emb_func', 'cls_classifier'], 'tag': None, 'epoch': 200, 'test_epoch': 5, 'parallel_part': ['emb_func'], 'pretrain_path': './results/DeepBDC/DeepBDC-meta-miniImageNet-5-1/checkpoints/emb_func_best.pth', 'resume': False, 'way_num': 5, 'shot_num': 1, 'query_num': 15, 'test_way': 5, 'test_shot': 1, 'test_query': 15, 'episode_size': 2, 'train_episode': 600, 'test_episode': 600, 'batch_size': 64, 'val_per_epoch': 1, 'optimizer': {'kwargs': {'lr': 0.0001, 'momentum': 0.9, 'nesterov': True, 'weight_decay': 0.0005}, 'name': 'SGD', 'other': None}, 'lr_scheduler': {'kwargs': {'gamma': 0.1, 'milestones': [40, 80]}, 'name': 'MultiStepLR'}, 'warmup': 0, 'includes': ['headers/device.yaml', 'headers/misc.yaml', 'headers/model.yaml', 'headers/optimizer.yaml'], 'augment_method': 'DeepBdcAugment', 'backbone': {'kwargs': {'reduce_dim': 640}, 'name': 'resnet12Bdc'}, 'classifier': {'kwargs': None, 'name': 'DeepBDC'}, 'rank': 0, 'tb_scale': 1.0}
2023-12-18 09:52:38,069 [INFO] core.test: DeepBDC(
  (emb_func): resnet(
    (layer1): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer2): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(64, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(64, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer3): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(160, 320, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (layer4): Sequential(
      (0): BasicBlockVariant(
        (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): LeakyReLU(negative_slope=0.1)
        (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn3): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (maxpool): MaxPool2d(kernel_size=1, stride=1, padding=0, dilation=1, ceil_mode=False)
        (downsample): Sequential(
          (0): Conv2d(320, 640, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (DropBlock): DropBlock()
      )
    )
    (dropout): Dropout(p=0.0, inplace=False)
    (bdc_pool): BdcPool()
  )
  (proto_layer): ProtoLayer()
  (loss_func): CrossEntropyLoss()
)
2023-12-18 09:52:38,119 [INFO] core.test: Trainable params in the model: 12424321.
2023-12-18 09:52:38,121 [INFO] core.test: Loading the state dict from ./results/DeepBDC-StanfordCar-resnet12Bdc-5-1-Dec-15-2023-21-18-07/checkpoints/model_best.pth.
2023-12-18 09:52:44,367 [INFO] core.test: load 4025 test image with 49 label.
2023-12-18 09:52:46,667 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:53:04,419 [INFO] core.test: Epoch-(0): [100/600]	Time 0.104 (0.354)	Calc 0.100 (0.097)	Data 0.001 (0.255)	Acc@1 74.000 (74.827)
2023-12-18 09:53:16,346 [INFO] core.test: Epoch-(0): [200/600]	Time 0.098 (0.296)	Calc 0.095 (0.096)	Data 0.001 (0.197)	Acc@1 79.333 (74.887)
2023-12-18 09:53:30,528 [INFO] core.test: Epoch-(0): [300/600]	Time 0.097 (0.292)	Calc 0.094 (0.095)	Data 0.001 (0.193)	Acc@1 74.000 (74.724)
2023-12-18 09:53:42,485 [INFO] core.test: Epoch-(0): [400/600]	Time 0.097 (0.278)	Calc 0.094 (0.095)	Data 0.001 (0.180)	Acc@1 66.667 (74.447)
2023-12-18 09:53:56,646 [INFO] core.test: Epoch-(0): [500/600]	Time 0.099 (0.279)	Calc 0.094 (0.095)	Data 0.001 (0.181)	Acc@1 68.000 (74.432)
2023-12-18 09:54:09,739 [INFO] core.test: Epoch-(0): [600/600]	Time 0.097 (0.276)	Calc 0.094 (0.095)	Data 0.001 (0.178)	Acc@1 74.667 (74.629)
2023-12-18 09:54:09,744 [INFO] core.test: Test Accuracy: 74.629	 h: 0.935
2023-12-18 09:54:09,746 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:54:22,881 [INFO] core.test: Epoch-(1): [100/600]	Time 0.097 (0.262)	Calc 0.095 (0.095)	Data 0.001 (0.165)	Acc@1 80.667 (76.187)
2023-12-18 09:54:37,708 [INFO] core.test: Epoch-(1): [200/600]	Time 0.724 (0.279)	Calc 0.094 (0.095)	Data 0.626 (0.182)	Acc@1 84.000 (75.400)
2023-12-18 09:54:51,322 [INFO] core.test: Epoch-(1): [300/600]	Time 0.426 (0.277)	Calc 0.094 (0.095)	Data 0.329 (0.179)	Acc@1 78.667 (75.493)
2023-12-18 09:55:04,723 [INFO] core.test: Epoch-(1): [400/600]	Time 0.101 (0.274)	Calc 0.098 (0.095)	Data 0.001 (0.177)	Acc@1 68.000 (75.800)
2023-12-18 09:55:17,286 [INFO] core.test: Epoch-(1): [500/600]	Time 0.098 (0.270)	Calc 0.095 (0.095)	Data 0.001 (0.172)	Acc@1 86.667 (75.448)
2023-12-18 09:55:31,120 [INFO] core.test: Epoch-(1): [600/600]	Time 0.098 (0.271)	Calc 0.095 (0.095)	Data 0.000 (0.173)	Acc@1 75.333 (75.549)
2023-12-18 09:55:31,124 [INFO] core.test: Test Accuracy: 75.549	 h: 0.856
2023-12-18 09:55:31,126 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:55:46,568 [INFO] core.test: Epoch-(2): [100/600]	Time 0.099 (0.308)	Calc 0.096 (0.096)	Data 0.001 (0.210)	Acc@1 71.333 (75.093)
2023-12-18 09:55:59,241 [INFO] core.test: Epoch-(2): [200/600]	Time 0.098 (0.281)	Calc 0.095 (0.095)	Data 0.001 (0.182)	Acc@1 62.000 (74.453)
2023-12-18 09:56:12,829 [INFO] core.test: Epoch-(2): [300/600]	Time 0.099 (0.277)	Calc 0.095 (0.095)	Data 0.001 (0.179)	Acc@1 78.000 (74.653)
2023-12-18 09:56:26,203 [INFO] core.test: Epoch-(2): [400/600]	Time 0.098 (0.275)	Calc 0.095 (0.095)	Data 0.001 (0.177)	Acc@1 82.667 (74.813)
2023-12-18 09:56:40,221 [INFO] core.test: Epoch-(2): [500/600]	Time 0.098 (0.276)	Calc 0.095 (0.095)	Data 0.001 (0.178)	Acc@1 79.333 (75.035)
2023-12-18 09:56:54,282 [INFO] core.test: Epoch-(2): [600/600]	Time 0.098 (0.277)	Calc 0.095 (0.095)	Data 0.001 (0.178)	Acc@1 70.667 (75.333)
2023-12-18 09:56:54,286 [INFO] core.test: Test Accuracy: 75.333	 h: 0.801
2023-12-18 09:56:54,288 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:57:07,665 [INFO] core.test: Epoch-(3): [100/600]	Time 0.098 (0.267)	Calc 0.095 (0.095)	Data 0.001 (0.169)	Acc@1 59.333 (74.173)
2023-12-18 09:57:24,231 [INFO] core.test: Epoch-(3): [200/600]	Time 0.098 (0.299)	Calc 0.095 (0.095)	Data 0.001 (0.201)	Acc@1 82.000 (74.487)
2023-12-18 09:57:36,683 [INFO] core.test: Epoch-(3): [300/600]	Time 0.098 (0.282)	Calc 0.095 (0.095)	Data 0.001 (0.184)	Acc@1 81.333 (74.551)
2023-12-18 09:57:50,605 [INFO] core.test: Epoch-(3): [400/600]	Time 0.098 (0.281)	Calc 0.095 (0.095)	Data 0.001 (0.183)	Acc@1 74.667 (74.767)
2023-12-18 09:58:03,591 [INFO] core.test: Epoch-(3): [500/600]	Time 0.098 (0.277)	Calc 0.095 (0.095)	Data 0.001 (0.179)	Acc@1 65.333 (74.765)
2023-12-18 09:58:16,393 [INFO] core.test: Epoch-(3): [600/600]	Time 0.585 (0.273)	Calc 0.095 (0.095)	Data 0.486 (0.175)	Acc@1 76.000 (75.071)
2023-12-18 09:58:16,398 [INFO] core.test: Test Accuracy: 75.071	 h: 0.874
2023-12-18 09:58:16,400 [INFO] core.test: ============ Testing on the test set ============
2023-12-18 09:58:30,558 [INFO] core.test: Epoch-(4): [100/600]	Time 0.099 (0.283)	Calc 0.095 (0.095)	Data 0.001 (0.185)	Acc@1 74.667 (73.933)
2023-12-18 09:58:43,089 [INFO] core.test: Epoch-(4): [200/600]	Time 0.099 (0.266)	Calc 0.095 (0.095)	Data 0.001 (0.168)	Acc@1 79.333 (74.120)
2023-12-18 09:58:58,035 [INFO] core.test: Epoch-(4): [300/600]	Time 1.336 (0.277)	Calc 0.095 (0.095)	Data 1.239 (0.179)	Acc@1 83.333 (74.636)
2023-12-18 09:59:12,278 [INFO] core.test: Epoch-(4): [400/600]	Time 0.953 (0.279)	Calc 0.094 (0.095)	Data 0.856 (0.180)	Acc@1 66.667 (74.440)
2023-12-18 09:59:25,386 [INFO] core.test: Epoch-(4): [500/600]	Time 0.099 (0.275)	Calc 0.095 (0.095)	Data 0.001 (0.177)	Acc@1 72.000 (74.328)
2023-12-18 09:59:38,372 [INFO] core.test: Epoch-(4): [600/600]	Time 0.098 (0.273)	Calc 0.095 (0.095)	Data 0.001 (0.174)	Acc@1 70.000 (74.529)
2023-12-18 09:59:38,376 [INFO] core.test: Test Accuracy: 74.529	 h: 0.872
2023-12-18 09:59:38,380 [INFO] core.test: Aver Accuracy: 75.022	 Aver h: 0.387
2023-12-18 09:59:38,382 [INFO] core.test: ............Testing is end............
